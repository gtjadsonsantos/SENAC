# 1 Crie uma consulta SQL que liste o nome e o telefone de cada proprietário, ordenado pelo nome;

SELECT 
TELEFONE_RESIDENCIAL
FROM PROPRIETARIO
ORDER BY NOME;

# 2 Crie uma consulta SQL que liste todos os serviços realizados pela oficina, ordenado pelo nome do serviço;

SELECT 
SERVICO.NOME
FROM ITEM_SERVICO 
    LEFT JOIN SERVICO ON  
    ITEM_SERVICO.IDSERVICO = SERVICO.IDSERVICO
ORDER BY SERVICO.NOME

# 3 Crie uma consulta SQL que liste todos os produtos vendidos pela oficina, ordenado pelo nome do produto;

SELECT 
PRODUTO.NOME
FROM ITEM_PRODUTO 
    INNER JOIN PRODUTO ON  
    ITEM_PRODUTO.IDPRODUTO = PRODUTO.IDPRODUTO
ORDER BY 
    PRODUTO.NOME

# 4 Crie uma consulta SQL que liste a quantidade de veículo por marca de veiculo;

SELECT 
MARCA,
COUNT(IDVEICULO)
FROM VEICULO
GROUP BY 
    MARCA
        
# 5 Liste os proprietários que fazem aniversario nos próximos 45 dias, listar quando será a data de aniversario, ordenado pela data de aniversario;​

SELECT
	PROPRIETARIO.IDPROPRIETARIO
	, PROPRIETARIO.NOME
	, PROPRIETARIO.DT_NASCIMENTO
	, CASE WHEN DATE_ADD(PROPRIETARIO.DT_NASCIMENTO, INTERVAL YEAR(NOW()) - YEAR(PROPRIETARIO.DT_NASCIMENTO) YEAR) < NOW() THEN
			DATE_ADD(PROPRIETARIO.DT_NASCIMENTO, INTERVAL (YEAR(NOW()) - YEAR(PROPRIETARIO.DT_NASCIMENTO)) + 1 YEAR)
		ELSE
			DATE_ADD(PROPRIETARIO.DT_NASCIMENTO, INTERVAL YEAR(NOW()) - YEAR(PROPRIETARIO.DT_NASCIMENTO) YEAR)
		END AS NIVER
FROM
	PROPRIETARIO
WHERE
CASE WHEN DATE_ADD(PROPRIETARIO.DT_NASCIMENTO, INTERVAL YEAR(NOW()) - YEAR(PROPRIETARIO.DT_NASCIMENTO) YEAR) < NOW() THEN
			DATE_ADD(PROPRIETARIO.DT_NASCIMENTO, INTERVAL (YEAR(NOW()) - YEAR(PROPRIETARIO.DT_NASCIMENTO)) + 1 YEAR)
		ELSE
			DATE_ADD(PROPRIETARIO.DT_NASCIMENTO, INTERVAL YEAR(NOW()) - YEAR(PROPRIETARIO.DT_NASCIMENTO) YEAR)
		END BETWEEN NOW() AND DATE_ADD(NOW(), INTERVAL 45 DAY);

# 6 Crie uma consulta SQL que liste todos os proprietários de veículos e seus respectivos carros, o proprietário deve ser listado mesmo não tendo carro;

SELECT	
	PROPRIETARIO.NOME,
    VEICULO.MODELO
FROM PROPRIETARIO 
	LEFT JOIN VEICULO ON 
    VEICULO.IDPROPRIETARIO = PROPRIETARIO.IDPROPRIETARIO


# 7 Crie uma consulta SQL que liste todos os carros e seus respectivos proprietários, ordenados por nome do proprietário;

SELECT	
	PROPRIETARIO.NOME,
    VEICULO.MODELO
FROM PROPRIETARIO 
	LEFT JOIN VEICULO ON 
    VEICULO.IDPROPRIETARIO = PROPRIETARIO.IDPROPRIETARIO
ORDER BY PROPRIETARIO.NOME

# 8 Crie uma consulta SQL que liste todos os mecânicos cadastrados na oficina;​

SELECT	
	MECANICO.*
FROM MECANICO

# 9 Crie uma consulta SQL que liste o nome e o valor de todos os produtos já utilizados em um orçamento pela oficina;

SELECT	
	PRODUTO.NOME,
    PRODUTO.VALOR
FROM PRODUTO
	INNER JOIN ITEM_PRODUTO ON
    PRODUTO.IDPRODUTO = ITEM_PRODUTO.IDPRODUTO
    INNER JOIN ORCAMENTO ON 
    ORCAMENTO.IDORCAMENTO = ITEM_PRODUTO.IDORCAMENTO

    

# 10 ​Crie uma consulta SQL que liste todos os orçamentos realizadas no carro com o código(IDVEICULO) igual à 3, você deve lista a quantidade de serviço realizado e a soma total dos valores do serviço;

SELECT	
	VEICULO.MODELO,
    SERVICO.NOME,
    COUNT(ITEM_SERVICO.IDSERVICO),
  	SUM(SERVICO.VALOR)
FROM ORCAMENTO
    LEFT JOIN ITEM_SERVICO ON
    ITEM_SERVICO.IDORCAMENTO = ORCAMENTO.IDORCAMENTO
    INNER JOIN VEICULO ON 
    ORCAMENTO.IDVEICULO = VEICULO.IDVEICULO
    LEFT JOIN SERVICO ON
    ITEM_SERVICO.IDSERVICO = SERVICO.IDSERVICO
WHERE 
	VEICULO.IDVEICULO = 3
GROUP BY
		VEICULO.MODELO,
        SERVICO.NOME

# 11 Crie uma consulta SQL que liste todos os orçamentos realizadas no carro com o código(IDVEICULO) igual à 3, você deve lista a quantidade de produto utilizado e a soma total de produto utilizado;


SELECT	
	VEICULO.MODELO,
    PRODUTO.NOME,
    COUNT(ITEM_PRODUTO.IDPRODUTO),
  	SUM(PRODUTO.VALOR)
FROM ORCAMENTO
    LEFT JOIN ITEM_PRODUTO ON
    ITEM_PRODUTO.IDORCAMENTO = ORCAMENTO.IDORCAMENTO
    INNER JOIN VEICULO ON 
    ORCAMENTO.IDVEICULO = VEICULO.IDVEICULO
    LEFT JOIN PRODUTO ON
    ITEM_PRODUTO.IDPRODUTO = PRODUTO.IDPRODUTO
WHERE 
	VEICULO.IDVEICULO = 3
GROUP BY
		VEICULO.MODELO,
        PRODUTO.NOME


# 12 Crie uma consulta SQL que liste todas os orçamentos realizadas no carro com o código(idcarro) igual à 2, liste também o nome do mecânico responsável pela manutenção;


SELECT	
	ORCAMENTO.*,
    MECANICO.NOME
FROM ORCAMENTO
	INNER JOIN MECANICO ON
    ORCAMENTO.IDMECANICO = MECANICO.IDMECANICO
WHERE 
	ORCAMENTO.IDVEICULO = 2

# 13 Crie uma consulta SQL que liste a quantidade de orçamentos por carro, desde que o ano de fabricação seja 2014;

SELECT
	VEICULO.MODELO,
	COUNT(ORCAMENTO.IDORCAMENTO)
FROM ORCAMENTO
	INNER JOIN VEICULO ON
    ORCAMENTO.IDVEICULO = VEICULO.IDVEICULO
WHERE 
	VEICULO.ANO_FABRICACAO = 2014
GROUP BY 
	VEICULO.MODELO

# 14 Crie uma consulta SQL que liste a media do valor pago em cada orçamento;

SELECT
	AVG(SERVICO.VALOR),
	ORCAMENTO.IDORCAMENTO
FROM ORCAMENTO
	INNER JOIN ITEM_SERVICO ON
    ITEM_SERVICO.IDORCAMENTO = ORCAMENTO.IDORCAMENTO
    INNER JOIN SERVICO ON
    ITEM_SERVICO.IDSERVICO = SERVICO.IDSERVICO
GROUP BY 
	ORCAMENTO.IDORCAMENTO


# 15 Crie uma consulta SQL que liste a quantidade de orçamentos realizados por mês e ano, a soma dos valores pagos, e a média paga em cada mês e ano;

SELECT
	COUNT(ORCAMENTO.IDORCAMENTO),
    SUM(SERVICO.VALOR),
    AVG(SERVICO.VALOR),
	MONTH(ORCAMENTO.DT_ORCAMENTO) AS MES,
    YEAR(ORCAMENTO.DT_ORCAMENTO) AS YEARN
FROM ORCAMENTO
	INNER JOIN ITEM_SERVICO ON
    ITEM_SERVICO.IDORCAMENTO = ORCAMENTO.IDORCAMENTO
    INNER JOIN SERVICO ON
    ITEM_SERVICO.IDSERVICO = SERVICO.IDSERVICO
GROUP BY 
	MONTH(ORCAMENTO.DT_ORCAMENTO),
    YEAR(ORCAMENTO.DT_ORCAMENTO)



